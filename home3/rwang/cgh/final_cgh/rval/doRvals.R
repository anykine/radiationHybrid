# this was using wrong build (hg17)
trans40 = read.table("/media/G3data/fdr/trans/unique_transFDR40.txt")
cis40 = read.table("/media/G3data/fdr/cis/unique_cisFDR40.txt")
trans30 = read.table("/media/G3data/fdr/trans/unique_transFDR30.txt")
cis30 = read.table("/media/G3data/fdr/cis/unique_cisFDR30.txt")
trans20 = read.table("/media/G3data/fdr/trans/unique_transFDR20.txt")
cis20 = read.table("/media/G3data/fdr/cis/unique_cisFDR20.txt")
rvals = read.table("rvals_in_gene_order.txt")
pdf(file="cis_trans_rval20.pdf",version="1.4")
#layout(matrix(c(1,2),2,1))
hist(-log10(rvals[trans20[,],2]),breaks=100,freq=F, col=rgb(1,0,0,0.5), ylim=c(0,5),xlim=c(-3,3),main="",xlab="")
par(new=T)
#x11()
hist(-log10(rvals[cis20[,],2]),breaks=100,freq=F, col=rgb(0,0,1,0.5),ylim=c(0,5),xlim=c(-3,3),main="",xlab="")
dev.off()

# hg 18
cis30=read.table("unique_cisFDR30.txt")
trans30 = read.table("unique_transFDR30.txt")
cis40=read.table("unique_cisFDR40.txt")
trans40 = read.table("unique_transFDR40.txt")
rvals = read.table("rvals_in_gene_order.txt")
h1 = hist(-log10(rvals[trans30[,1],2]),breaks=100, freq=F, ylim=c(0,0.3), xlim=c(-3,3), col=rgb(0,0,1,0.5))
h1$counts = h1$counts/sum(h1$counts)
h2 = hist(-log10(rvals[cis30[,1],2]), breaks=100, freq=F, ylim=c(0,0.3), xlim=c(-3,3), col=rgb(1,0,0, 0.5))
h2$counts = h2$counts/sum(h2$counts)
#par(mfrow=c(2,1))
pdf(file="test30.pdf",version="1.4")
plot(h1, col=rgb(1,0,0,0.5), ylim=c(0,0.3))
par(new=T)
plot(h2, col=rgb(0,0,1,0.5), ylim=c(0,0.3), axes=F)
dev.off()
